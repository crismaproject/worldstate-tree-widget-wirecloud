angular.module("de.cismet.crisma.widgets.worldstateTreeWidgetWirecloud",["de.cismet.crisma.widgets.worldstateTreeWidget","de.cismet.crisma.ICMM.Worldstates","de.cismet.commons.angular.angularTools"]).controller("de.cismet.crisma.widgets.worldstateTreeWidgetWirecloud.wire",["$scope","$q","de.cismet.crisma.ICMM.Worldstates","de.cismet.commons.angular.angularTools.AngularTools","IMAGE_PATH","LEAF_ICON","FOLDER_ICON_CLOSED","FOLDER_ICON_OPEN","MULTI_SELECT","OPEN_FOLDER_ON_CLICK","DEBUG",function(e,t,o,s,n,r,c,i,a,l,d){"use strict";var f,g,I;"undefined"==typeof MashupPlatform||(f=MashupPlatform,e.activeItem={},e.treeSelection=[],e.treeOptions={checkboxClass:"glyphicon glyphicon-unchecked",folderIconClosed:c,folderIconOpen:i,leafIcon:r,imagePath:n,multiSelection:"true"===a.toLowerCase(),clickFolderMode:"true"===l.toLowerCase()?3:1},e.$watch("treeSelection",function(e){var t,o,s;if(o=[],e)for(t=0;e.length>t;++t)e[t].id&&o.push(e[t].id);s=JSON.stringify(o),f.wiring.pushEvent("getSelectedWorldstates",s)},!0),e.$watch("activeItem",function(e,t){var o;e&&t&&e.objectKey&&t.objectKey&&e.objectKey===t.objectKey||(o=-1,e&&e.id&&(o=e.id),f.wiring.pushEvent("getActiveWorldstate",""+o))}),I=function(n){var r,c,i,a;if(i=function(t){s.safeApply(e,function(){e.treeSelection=t})},n)try{if(a=JSON.parse(n),$.isArray(a)){for(c=[],r=0;a.length>r;++r)c[r]=o.get({wsId:a[r]}).$promise;t.all(c).then(function(e){i(e)})}else i([])}catch(l){d&&console.log(l),i([])}else i([])},g=function(t){var s,n;if(n=function(t){e.activeItem=t},t)try{s=parseInt(t,10),o.get({wsId:s}).$promise.then(function(e){n(e)})}catch(r){d&&console.log(r),n({})}else n({})},f.wiring.registerCallback("setSelectedWorldstates",I),f.wiring.registerCallback("setActiveWorldstate",g))}]).config(["$provide",function(e){"use strict";var t;"undefined"==typeof MashupPlatform?console.log("mashup platform not available"):(t=MashupPlatform,e.constant("DEBUG",t.prefs.get("DEBUG")),e.constant("CRISMA_DOMAIN",t.prefs.get("CRISMA_DOMAIN")),e.constant("CRISMA_ICMM_API",t.prefs.get("CRISMA_ICMM_API")),e.constant("IMAGE_PATH",t.prefs.get("IMAGE_PATH")),e.constant("LEAF_ICON",t.prefs.get("LEAF_ICON")),e.constant("FOLDER_ICON_CLOSED",t.prefs.get("FOLDER_ICON_CLOSED")),e.constant("FOLDER_ICON_OPEN",t.prefs.get("FOLDER_ICON_OPEN")),e.constant("MULTI_SELECT",t.prefs.get("MULTI_SELECT")),e.constant("OPEN_FOLDER_ON_CLICK",t.prefs.get("OPEN_FOLDER_ON_CLICK")))}]);