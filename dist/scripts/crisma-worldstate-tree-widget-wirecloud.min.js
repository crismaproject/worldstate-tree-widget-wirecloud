angular.module("de.cismet.crisma.widgets.worldstateTreeWidgetWirecloud",["de.cismet.crisma.widgets.worldstateTreeWidget","de.cismet.cids.rest.collidngNames.Nodes"]).controller("de.cismet.crisma.widgets.worldstateTreeWidgetWirecloud.wire",["$scope","$q","de.cismet.collidingNameService.Nodes","IMAGE_PATH","LEAF_ICON","FOLDER_ICON_CLOSED","FOLDER_ICON_OPEN","MULTI_SELECT","OPEN_FOLDER_ON_CLICK","DEBUG",function(e,t,o,s,n,c,r,i,a,l){"use strict";var d,f,I;"undefined"==typeof MashupPlatform||(d=MashupPlatform,e.activeItem={},e.treeSelection=[],e.treeOptions={checkboxClass:"glyphicon glyphicon-unchecked",folderIconClosed:c,folderIconOpen:r,leafIcon:n,imagePath:s,multiSelection:"true"===i.toLowerCase(),clickFolderMode:"true"===a.toLowerCase()?3:1},o.query(function(t){e.nodes=t}),e.$watch("treeSelection",function(e){var t,o,s,n;if(s=[],e)for(t=0;e.length>t;++t)e[t].objectKey&&(o=parseInt(e[t].objectKey.substr(e[t].objectKey.lastIndexOf("/")+1),10),s.push(o));n=JSON.stringify(s),d.wiring.pushEvent("getSelectedWorldstates",n)},!0),e.$watch("activeItem",function(e,t){var o;e&&t&&e.objectKey&&t.objectKey&&e.objectKey===t.objectKey||(o=-1,e&&e.objectKey&&(o=parseInt(e.objectKey.substr(e.objectKey.lastIndexOf("/")+1),10)),d.wiring.pushEvent("getActiveWorldstate",""+o))}),I=function(s){var n,c,r,i;if(r=function(t){e.treeSelection=t},s)try{if(i=JSON.parse(s),$.isArray(i)){for(c=[],n=0;i.length>n;++n)c[n]=o.get({nodeId:i[n]}).$promise;t.all(c).then(function(e){r(e)})}else r([])}catch(a){l&&console.log(a),r([])}else r([])},f=function(t){var s,n;if(n=function(t){e.activeItem=t},t)try{s=parseInt(t,10),o.get({nodeId:s}).$promise.then(function(e){n(e)})}catch(c){l&&console.log(c),n({})}else n({})},d.wiring.registerCallback("setSelectedWorldstates",I),d.wiring.registerCallback("setActiveWorldstate",f))}]).config(["$provide",function(e){"use strict";var t;"undefined"==typeof MashupPlatform?console.log("mashup platform not available"):(t=MashupPlatform,e.constant("DEBUG",t.prefs.get("DEBUG")),e.constant("CRISMA_DOMAIN",t.prefs.get("CRISMA_DOMAIN")),e.constant("CRISMA_ICMM_API",t.prefs.get("CRISMA_ICMM_API")),e.constant("IMAGE_PATH",t.prefs.get("IMAGE_PATH")),e.constant("LEAF_ICON",t.prefs.get("LEAF_ICON")),e.constant("FOLDER_ICON_CLOSED",t.prefs.get("FOLDER_ICON_CLOSED")),e.constant("FOLDER_ICON_OPEN",t.prefs.get("FOLDER_ICON_OPEN")),e.constant("MULTI_SELECT",t.prefs.get("MULTI_SELECT")),e.constant("OPEN_FOLDER_ON_CLICK",t.prefs.get("OPEN_FOLDER_ON_CLICK")))}]);