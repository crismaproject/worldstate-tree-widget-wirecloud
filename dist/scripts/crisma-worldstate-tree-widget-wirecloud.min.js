angular.module("de.cismet.crisma.widgets.worldstateTreeWidgetWirecloud",["de.cismet.crisma.widgets.worldstateTreeWidget","de.cismet.crisma.ICMM.Worldstates","de.cismet.commons.angular.angularTools"]).controller("de.cismet.crisma.widgets.worldstateTreeWidgetWirecloud.wire",["$scope","$q","de.cismet.crisma.ICMM.Worldstates","de.cismet.commons.angular.angularTools.AngularTools","IMAGE_PATH","LEAF_ICON","FOLDER_ICON_CLOSED","FOLDER_ICON_OPEN","MULTI_SELECT","OPEN_FOLDER_ON_CLICK","DEBUG",function(e,t,r,n,o,s,i,a,c,l,d){"use strict";var f,g,u,I,O;"undefined"==typeof MashupPlatform||(u=MashupPlatform,g=[],e.activeItem={},e.treeSelection=[],e.treeOptions={checkboxClass:"glyphicon glyphicon-unchecked",folderIconClosed:i,folderIconOpen:a,leafIcon:s,imagePath:o,multiSelection:"true"===c.toLowerCase(),clickFolderMode:"true"===l.toLowerCase()?3:1},e.$watch("treeSelection",function(e){var t,r,n;if(r=[],e)for(t=0;e.length>t;++t)e[t].id&&r.push(e[t].id);f(r,g)||(g=r,n=JSON.stringify(r),u.wiring.pushEvent("getSelectedWorldstates",n))},!0),e.$watch("activeItem",function(e,t){var r;e&&t&&e.id&&t.id&&e.id===t.id||(r=-1,e&&e.id&&(r=e.id),u.wiring.pushEvent("getActiveWorldstate",""+r))}),O=function(o){var s,i,a,c;if(a=function(t){n.safeApply(e,function(){e.treeSelection=t})},o)try{if(c=JSON.parse(o),$.isArray(c)){for(i=[],s=0;c.length>s;++s)i[s]=r.get({wsId:c[s]}).$promise;t.all(i).then(function(e){a(e)})}else a([])}catch(l){d&&console.log(l),a([])}else a([])},I=function(t){var n;if(n=function(t){e.activeItem=t},t)try{r.get({wsId:t}).$promise.then(function(e){n(e)})}catch(o){d&&console.log(o),n({})}else n({})},f=function(e,t){var r;if(e===t)return!0;if(null===e||null===t)return!1;if(e.length!==t.length)return!1;for(e=e.sort(),t=t.sort(),r=0;e.length>r;++r)if(e[r]!==t[r])return!1;return!0},u.wiring.registerCallback("setSelectedWorldstates",O),u.wiring.registerCallback("setActiveWorldstate",I))}]).config(["$provide",function(e){"use strict";var t;"undefined"==typeof MashupPlatform?console.log("mashup platform not available"):(t=MashupPlatform,e.constant("DEBUG",t.prefs.get("DEBUG")),e.constant("CRISMA_DOMAIN",t.prefs.get("CRISMA_DOMAIN")),e.constant("CRISMA_ICMM_API",t.prefs.get("CRISMA_ICMM_API")),e.constant("IMAGE_PATH",t.prefs.get("IMAGE_PATH")),e.constant("LEAF_ICON",t.prefs.get("LEAF_ICON")),e.constant("FOLDER_ICON_CLOSED",t.prefs.get("FOLDER_ICON_CLOSED")),e.constant("FOLDER_ICON_OPEN",t.prefs.get("FOLDER_ICON_OPEN")),e.constant("MULTI_SELECT",t.prefs.get("MULTI_SELECT")),e.constant("OPEN_FOLDER_ON_CLICK",t.prefs.get("OPEN_FOLDER_ON_CLICK")))}]);